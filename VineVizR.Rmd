---
title: "Iris K-Means Clustering"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    social: menu
    source_code: embed
runtime: shiny
---

```{r global, include=FALSE}
# load data in 'global' chunk so it can be shared by all users of the dashboard

for(i in list.files("R/", full.names = T)) source(i)

# Download Top40 on JSE
load_pkg(c(
  "dplyr", 
  "tidyr",
  "tibble",
  "ggplot2",
  "quantmod",
  "PerformanceAnalytics",
  "rugarch",
  "VineCopula",
  "visNetwork"
))


```




Column {.sidebar}
-----------------------------------------------------------------------

```{r}
selectInput('group', 'Generate Grouping', c("Market Cap", "Industry", "Volatility"))

numericInput('seed', 'Random formation seed', 3, 
              min = 1, max = 999)
```

Column
-----------------------------------------------------------------------
```{r}
require(visNetwork, quietly = TRUE)
# minimal example

if (input$group == "Market Cap")
{
    group <- 
    group.size <- 
    colours <- c("#39c9bb", 	"#398fc9", 	"#39c973")
} else if (input$group == "Industry"){
    group <- 
    group.size <- 
    colours <- c("#39c9bb", 	"#398fc9", 	"#39c973")
} else if (input$group == "X Month Performance"){
    group <- 
    group.size <- 
    colours <- c("#39c9bb", 	"#398fc9", 	"#39c973")
}


colours <- colorspace::rainbow_hcl(3)

#pie(rep(1,12), col=colours) 

renderVisNetwork({
  RVM <- readRDS("data/RVM.rds")

  VisVineR(
    RVM,
    group = c("Fin", "Retail", "IT"),
    group.size = c(12, 9, 2),
    seed = 5, 
    colours = colours
    )
  })

```

